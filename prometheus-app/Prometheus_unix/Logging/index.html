<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Logging (prometheus-app.Prometheus_unix.Logging)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">prometheus-app</a> &#x00BB; <a href="../index.html">Prometheus_unix</a> &#x00BB; Logging</nav><h1>Module <code>Prometheus_unix.Logging</code></h1><p>Report metrics for messages logged.</p></header><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>?&#8288;default_level:Logs.level</span> <span>&#45;&gt;</span> <span>?&#8288;levels:<span><span>(string * Logs.level)</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;formatter:Stdlib.Format.formatter</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Initialise the Logs library with a reporter that reports prometheus metrics too. The reporter is configured to log to stderr and the log messages include a timestamp and the event's source.</p><p>A server will typically use the following code to initialise logging:</p><pre><code class="ml">let () = Prometheus_app.Logging.init ()</code></pre><p>Or:</p><pre><code class="ml">let () =
  Prometheus_unix.Logging.init ()
    ~default_level:Logs.Debug
    ~levels:[
      &quot;cohttp.lwt.io&quot;, Logs.Info;
    ]</code></pre><dl><dt>parameter default_level</dt><dd><p>The default log-level to use (default <span class="xref-unresolved" title="unresolved reference to &quot;Logs.Info&quot;"><code>Logs</code>.Info</span>).</p></dd></dl><dl><dt>parameter levels</dt><dd><p>Provides levels for specific log sources.</p></dd></dl><dl><dt>parameter formatter</dt><dd><p>A custom formatter (default <span class="xref-unresolved" title="unresolved reference to &quot;Fmt.stderr&quot;"><code>Fmt</code>.stderr</span>).</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-inc_counter"><a href="#val-inc_counter" class="anchor"></a><code><span class="keyword">val</span> inc_counter : Logs.level <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>inc_counter level src</code> increments the count of messages logged by <code>src</code> at <code>level</code>. The reporter installed by <code>init</code> calls this automatically, but you might want to use this if you use your own reporter instead.</p></dd></dl></div></body></html>